<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="cheer up"><meta name="baidu-site-verification" content="9pSIuwCbvi"><meta name="google-site-verification" content="YzcCTjF6VoVlNAtL37_S4vFjzFwYTAFZzD51Il2IGKY"><title>cross entropy äº¤å‰ç†µä»¥åŠsoftmax | WenHuiZhou</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.3.1/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">cross entropy äº¤å‰ç†µä»¥åŠsoftmax</h1><a id="logo" href="/.">WenHuiZhou</a><p class="description">perperï¼ˆæ‰“èµ·ç²¾ç¥ï¼ï¼‰</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> é¦–é¡µ</i></a><a href="/archives/"><i class="fa fa-archive"> å½’æ¡£</i></a><a href="/about/"><i class="fa fa-user"> å…³äº</i></a><a href="/atom.xml"><i class="fa fa-rss"> è®¢é˜…</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">cross entropy äº¤å‰ç†µä»¥åŠsoftmax</h1><div class="post-meta">Feb 20, 2019<span> | </span><span class="category"><a href="/categories/è®ºæ–‡é˜…è¯»/">è®ºæ–‡é˜…è¯»</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> é˜…è¯»</span></span></div><a class="disqus-comment-count" href="/2019/02/20/cross-entropy-äº¤å‰ç†µä»¥åŠsoftmax/#vcomment"><span class="valine-comment-count" data-xid="/2019/02/20/cross-entropy-äº¤å‰ç†µä»¥åŠsoftmax/"></span><span> æ¡è¯„è®º</span></a><div class="post-content"><h3 id="cross-entropy-äº¤å‰ç†µä»¥åŠsoftmax"><a href="#cross-entropy-äº¤å‰ç†µä»¥åŠsoftmax" class="headerlink" title="cross entropy äº¤å‰ç†µä»¥åŠsoftmax"></a>cross entropy äº¤å‰ç†µä»¥åŠsoftmax</h3><p>äº¤å‰ç†µå¸¸å¸¸ç”¨åœ¨CNNç½‘ç»œä¸­ï¼Œä½œä¸ºç½‘ç»œçš„lossï¼Œä»–æè¿°çš„æ˜¯æ¨¡å‹æ•°æ®åˆ†å¸ƒä¸è®­ç»ƒæ•°æ®ä¹‹é—´çš„ç›¸ä¼¼ç¨‹åº¦ã€‚æœ€å°åŒ–äº¤å‰ç†µç­‰ä»·äºæ¨¡å‹äº§ç”Ÿæ•°æ®ä¸è®­ç»ƒæ•°æ®ç›¸ä¼¼åº¦è¶Šé«˜ã€‚</p>
<p><strong>ä¿¡æ¯é‡ï¼š</strong><br>ç”¨æ¥è¡¡é‡ä¸€ä»¶äº‹æƒ…çš„ä¸ç¡®å®šç¨‹åº¦ï¼Œä¸€ä»¶äº‹æƒ…å‘ç”Ÿæ¦‚ç‡è¶Šå¤§ï¼Œä»–çš„ä¸ç¡®å®šæ€§è¶Šå°ï¼Œä¿¡æ¯é‡è¶Šå°‘ã€‚ä¿¡æ¯é‡çš„è®¡ç®—å…¬å¼ä¸ºï¼š<br>$$<br>I(x_0) = - \log(P(x_0))<br>$$<br>ä¾‹å¦‚ï¼Œå½“$p(x_0) = 0.1,I(x_0) = 3.32$ï¼Œ$p(x_0) = 0.999,I(x_0) = 0.0014$</p>
<p><strong>ç†µï¼š</strong><br>ç”¨äºè¡¡é‡ä¸€ä¸ªç³»ç»Ÿçš„æ··ä¹±ç¨‹åº¦ï¼Œä»£è¡¨ä¸€ä¸ªç³»ç»Ÿä¿¡æ¯é‡çš„æ€»å’Œã€‚å½“ä¸€ä¸ªç³»ç»Ÿä¿¡æ¯é‡è¶Šå¤§è¶Šä¸ç¨³å®šã€‚ç†µç­‰äºæ‰€æœ‰äº‹ä»¶æ‰€å¸¦æ¥çš„ä¿¡æ¯æœŸæœ›æ€»å’Œã€‚<br>$$<br>H(x) = - \sum_{x\in X}p(x) \log p(x)<br>$$<br><strong>äº¤å‰ç†µï¼š</strong><br>äº¤å‰ç†µæè¿°ä¸¤ä¸ªäº‹ä»¶ä¹‹é—´çš„ç›¸äº’å…³ç³»ï¼š<br>$$<br>H(A,B) = -\sum_i P_{A}(x_i)log(P_{B}(x_i))<br>$$</p>
<p><strong>å¦‚ä½•è®¡ç®—ä¸¤ä¸ªåˆ†å¸ƒä¹‹é—´çš„ä¸åŒï¼š KLæ•£åº¦</strong><br>KLæ•£åº¦ï¼Œæœ‰æ—¶å€™ä¹Ÿå«KLè·ç¦»ï¼Œä¸€èˆ¬è¢«ç”¨äºè®¡ç®—ä¸¤ä¸ªåˆ†å¸ƒä¹‹é—´çš„ä¸åŒï¼ŒKLæ•£åº¦ä¸å…·å¤‡æœ‰å¯¹ç§°æ€§ã€‚<br>$$<br>D_{KL}(A||B) = \sum_i P_A(x_i)\log(\frac{P_A(x_i)}{P_B(x_i)}) = \sum_{i}P_{A}(x_i)log(P_{A}(x_i ))- \sum_i P_{A}(x_i)log(P_{B}(x_i))<br>$$<br>ç”±ä¸Šå¼å¯ä»¥å‘ç°ï¼Œ<strong>KLæ•£åº¦ = - ç†µ + äº¤å‰ç†µ</strong>ï¼Œå½“ç†µå›ºå®šä¸å˜æ—¶ï¼Œè®¤ä¸ºäº¤å‰ç†µç­‰ä»·äºKLæ•£åº¦ã€‚</p>
<p><strong>æœºå™¨å­¦ä¹ ä¸­ä½¿ç”¨äº¤å‰ç†µä»£æ›¿KLæ•£åº¦ï¼š</strong><br>æœºå™¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­å¸Œæœ›åœ¨è®­ç»ƒæ•°æ®ä¸Šæ¨¡å‹å­¦åˆ°çš„åˆ†å¸ƒ P(model) å’Œè®­ç»ƒæ•°æ®groundtruthçš„åˆ†å¸ƒ P(real) è¶Šæ¥è¿‘è¶Šå¥½ï¼Œå¯ä»¥é€šè¿‡ä¼˜åŒ–KLæ•£åº¦ï¼Œä½¿å…¶KLæ•£åº¦æœ€å°æ¥è¾¾åˆ°ç›®çš„ã€‚<strong>ç”±äºè®­ç»ƒæ•°æ®groundtruthæ˜¯å›ºå®šçš„å› æ­¤æ±‚è§£KLæ•£åº¦å°†ä¼šç­‰ä»·äºæ±‚è§£äº¤å‰ç†µã€‚</strong>å› æ­¤æœ€å°åŒ–äº¤å‰ç†µå°†ä¼šå¾—åˆ°ä¸€ä¸ªæ¯”è¾ƒå¥½æ¨¡å‹ã€‚</p>
<p><strong>softmaxï¼š</strong><br>åœ¨ç¥ç»ç½‘ç»œåˆ†ç±»ä»»åŠ¡æ¥è¯´ï¼Œæœ€åä¸€å±‚å°†ä¼šè¾“å‡ºxçš„ä¸€ç»´ç‰¹å¾ï¼Œ<strong>æ¯ä¸€ä¸ªä½ç½®è¡¨ç¤ºä¸€ä¸ªç‰¹å¾è¡¨ç¤ºå€¼ã€‚è¿™ä¸ªè¡¨ç¤ºå€¼è¶Šå¤§è®¤ä¸ºè¿™å¼ å›¾ç‰‡æ˜¯è¿™ä¸ªç±»åˆ«çš„æ¦‚ç‡è¶Šå¤§ã€‚</strong>å› æ­¤å¯ä»¥ç”¨ç‰¹å¾è¡¨ç¤ºå€¼æ¥åˆ¤æ–­ç±»åˆ«ã€‚ä½†æ˜¯åœ¨å®é™…è¿ç”¨ä¸­ï¼Œç‰¹å¾è¡¨ç¤ºå€¼çš„ç”¨é€”ä¸å¤§, æˆ‘ä»¬æ›´å¸Œæœ›å¾—åˆ°å…·æœ‰ç»Ÿè®¡æ„ä¹‰çš„æ¦‚ç‡ã€‚ä¾‹å¦‚å¯ä»¥åˆ©ç”¨æ¦‚ç‡æ¥ä¼˜åŒ–KLæ•£åº¦ï¼Œä½¿å¾—é¢„æµ‹ç»“æœæ›´åŠ å‡†ç¡®ã€‚<strong>softmaxå®ƒå°†å¤šä¸ªç¥ç»å…ƒçš„è¾“å‡ºï¼Œæ˜ å°„åˆ°ï¼ˆ0,1ï¼‰åŒºé—´å†…ï¼Œè¡¨ç¤ºç±»åˆ«çš„æ¦‚ç‡ï¼Œä»è€Œè¿›è¡Œå¤šåˆ†ç±»ã€‚</strong><br>softmaxçš„å…¬å¼å¦‚ä¸‹ï¼š<br>$$<br>S_i = \frac{e^{V_i}}{\sum_j{e^{V_j}}}<br>$$<br>å…¶ä¸­Vè¡¨ç¤ºç¥ç»ç½‘ç»œè¾“å‡ºçš„ä¸€ç»´æ•°ç»„ã€‚</p>
<p>softmaxåœ¨å®é™…ä½¿ç”¨æ—¶éœ€è¦æ³¨æ„æ•°å€¼æº¢å‡ºçš„é—®é¢˜ã€‚å¦‚ä¸Šå…¬å¼ï¼Œåœ¨è®¡ç®—æ¦‚ç‡çš„æ—¶å€™å­˜åœ¨æŒ‡æ•°è¿ç®—ï¼Œå½“Væ•°å€¼å¾ˆå¤§çš„æ—¶å€™å°†ä¼šå‘ç”Ÿæº¢å‡ºã€‚å› æ­¤éœ€è¦å¯¹ä¸Šå¼åšä¸€ä¸‹å¤„ç†ï¼Œå°†æŒ‡æ•°éƒ¨åˆ†åŒæ—¶å‡å»æŒ‡æ•°ä¸­çš„æœ€å¤§å€¼ã€‚<br>$$<br>D = max(V) \\<br>S_i = \frac{e^{V_i - D}}{\sum_j{e^{V_j - D}}} = \frac{e^{V_i}}{\sum_j{e^{V_j}}} / \frac{D}{D}<br>$$<br>ç»è¿‡å¤„ç†åï¼Œä¿è¯æ•°å€¼ä¸ä¼šå‘ç”Ÿæº¢å‡ºç°è±¡ã€‚</p>
<h3 id="ç¥ç»ç½‘ç»œä¸­çš„åº”ç”¨"><a href="#ç¥ç»ç½‘ç»œä¸­çš„åº”ç”¨" class="headerlink" title="ç¥ç»ç½‘ç»œä¸­çš„åº”ç”¨"></a>ç¥ç»ç½‘ç»œä¸­çš„åº”ç”¨</h3><p>å¤§å¤šæ•°çš„CNNç½‘ç»œä¸­ï¼Œå‡é€‚ç”¨softmax + cross entropyä½œä¸ºæŸå¤±å‡½æ•°ã€‚<br>é¦–å…ˆæ˜¯äº¤å‰ç†µLOSSï¼š<br>$$<br>Loss = -\sum_i P_{groundtruth} \log P_{predict}<br>$$<br>å…¶ä¸­$P_{groundtruth}$æ˜¯çœŸå€¼çš„ç±»åˆ«åˆ†å¸ƒæ¦‚ç‡ã€‚åœ¨å¤šåˆ†ç±»é—®é¢˜ä¸­ï¼Œä¸€å¼ å›¾ç‰‡åªå±äºä¸€ä¸ªç±»åˆ«ï¼Œå› æ­¤$P_{groundtruth}$è¡¨ç¤ºæˆone hotç¼–ç ï¼Œå³[0,0,â€¦,1,0,0]è¿™ç§å½¢å¼ã€‚å¯¹äº$P_{predict}$æ¥è¯´ï¼Œç¥ç»ç½‘ç»œè¾“å‡ºçš„ç‰¹å¾å€¼ç»è¿‡softmaxå±‚ï¼Œè½¬æ¢ä¸ºæ¦‚ç‡çš„å½¢å¼ã€‚å› æ­¤Loss æœ€ç»ˆä¼šç­‰äºï¼š$$-\log p_i$$iè¡¨ç¤ºè¿™ä¸ªå›¾ç‰‡çœŸå®çš„ç±»åˆ«ã€‚</p>
<h4 id="äº¤å‰ç†µ-softmaxåå‘æ±‚å¯¼ï¼š"><a href="#äº¤å‰ç†µ-softmaxåå‘æ±‚å¯¼ï¼š" class="headerlink" title="äº¤å‰ç†µ+ softmaxåå‘æ±‚å¯¼ï¼š"></a><strong>äº¤å‰ç†µ+ softmaxåå‘æ±‚å¯¼ï¼š</strong></h4><p>ç”±ä¸Šå¼å¯çŸ¥ï¼Œäº¤å‰ç†µçš„å½¢å¼éå¸¸ç®€å•ï¼Œå…¶ä¸­$p_i$ç”±softmaxè®¡ç®—å¾—åˆ°ã€‚å¸¦å…¥softmaxå…¬å¼ï¼Œå¾—åˆ°äº¤å‰ç†µæœ€åçš„å½¢å¼ä¸ºï¼š<br>$$<br>L =  - \log \frac{e^{V_{i}}}{\sum_j e^{V_{j}}}<br>$$</p>
<p><strong>å¯¹äº¤å‰ç†µçš„æ±‚å¯¼ï¼š</strong><br>åœ¨è¿›è¡ŒBPæ–¹å‘ä¼ æ’­çš„æ—¶å€™ï¼Œæ›´æ–°å‚æ•°çš„æ—¶å€™ï¼Œè¯¯å·®éœ€è¦ç”±äº¤å‰ç†µæä¾›ï¼Œå³$-\log p_i$ï¼Œç„¶åå¯¹æ¯ä¸€ä¸ªå‚æ•°å€¼é€šè¿‡é“¾å¼æ³•åˆ¶éƒ½æ±‚ä¸€æ¬¡åå¯¼,ä¾‹å¦‚å¯¹$W_{ij}$ï¼š<br>$$<br>\frac{\partial{L}}{\partial{W_{ij}}} = - \frac{1}{\frac{e^{a_i}}{\sum_k e^{a_k}}} \frac{\partial{ \frac{e^{a_i}}{\sum_k e^{a_k}} }}{\partial{a_{j}}} \frac{\partial{a_j}}{\partial{W_{ij}}}<br>$$<br><strong>å¯¹softmaxè¿›è¡Œæ±‚å¯¼å¦‚ä¸‹ï¼š</strong><br>ä¸Šå¼ä¸­é—´éƒ¨åˆ†ä¸ºå¯¹softmaxæ±‚å¯¼ï¼Œä»¤<br>$$<br> y_i = \frac{e^{a_i}}{\sum_{k=1}^{C}e^{a_k}}<br>$$<br>å¯¹softmaxæ±‚åå¯¼æ•°ï¼š<br>$$<br>\frac{\partial{y_{i}}}{\partial{a_{j}}} = \frac{\partial{ \frac{e^{a_i}}{\sum_k e^{a_k}} }}{\partial{a_{j}}}<br>$$<br>å½“ <code>i!=j</code> æ—¶ï¼š<br>$$<br>\frac{\partial{y_{i}}}{\partial{a_{j}}} = \frac{\partial{ \frac{e^{a_i}}{\sum_{k=1}^{C}e^{a_k}} }}{\partial{a_{j}}}= \frac{ 0 - e^{a_i}e^{a_j}}{\Sigma^2}=-\frac{e^{a_i}}{\Sigma}\frac{e^{a_j}}{\Sigma}=-y_iy_j<br>$$<br>å½“ <code>i==j</code> æ—¶ï¼š<br>$$<br>\frac{\partial{y_{i}}}{\partial{a_{j}}} = \frac{\partial{ \frac{e^{a_i}}{\sum_{k=1}^{C}e^{a_k}} }}{\partial{a_{j}}}= \frac{ e^{a_i}\Sigma - e^{a_i}e^{a_j}}{\Sigma^2}=\frac{e^{a_i}}{\Sigma}\frac{\Sigma - e^{a_j}}{\Sigma}=y_i(1 - y_j)<br>$$<br>æ±‚å¯¼è¿‡ç¨‹æ¯”è¾ƒç®€å•ï¼Œç®—ä¸€ä¸‹å°±çŸ¥é“äº†ï¼Œä¸è¦å®³æ€•ã€‚å¾—åˆ°è¯¯å·®å¯¹æƒé‡çš„åå¯¼æ•°å°±å¯ä»¥å¯¹è¯¥æƒé‡è¿›è¡Œæ›´æ–°äº†ï¼ŒCNNç½‘ç»œé€šå¸¸ä½¿ç”¨çš„æ›´æ–°æ–¹å¼ä¸ºSGDã€‚</p>
<h4 id="SGD-éšæœºæ¢¯åº¦ä¸‹é™æ³•"><a href="#SGD-éšæœºæ¢¯åº¦ä¸‹é™æ³•" class="headerlink" title="SGD éšæœºæ¢¯åº¦ä¸‹é™æ³•"></a>SGD éšæœºæ¢¯åº¦ä¸‹é™æ³•</h4><p>æœ€ä¼˜åŒ–ç®—æ³•çš„æ ¸å¿ƒæ˜¯ä»å½“å‰ç‚¹èµ°åˆ°ä¸‹ä¸€ä¸ªç‚¹ï¼Œæ˜¯çš„ç›®æ ‡å‡½æ•°å¾—åˆ°ä¸‹é™ã€‚å³$x_0 -&gt; x_1$ï¼Œæœ€ä¼˜åŒ–ç®—æ³•è€ƒè™‘ä¸¤ä¸ªé—®é¢˜ï¼Œå³ä»å½“å‰ç‚¹ï¼Œ<strong>ç§»åŠ¨çš„æ–¹å‘å’Œæ­¥é•¿</strong>ã€‚å¯ä»¥å†™æˆä¸‹é¢å½¢å¼ï¼š<br>$$<br>x_{k+1} = x_k + \eta P_k<br>$$<br>å…¶ä¸­$P_k$æ˜¯å‰è¿›æ–¹å‘ã€‚ä»¤$P_k = -\nabla f_k$ï¼Œå³è´Ÿæ¢¯åº¦æ–¹å‘æ—¶ï¼Œä¸‹é™é€Ÿåº¦æœ€å¿«ã€‚è¿™ç§æ–¹æ³•åœ¨åŠå…¶å­¦ä¹ ä¸­ç§°ä¸ºæ¢¯åº¦ä¸‹é™æ³•ã€‚ä»–æœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œå°±æ˜¯éœ€è¦ä¸¥æ ¼æ±‚è§£å‡ºæ•´ä¸ªæ•°æ®é›†çš„æ¢¯åº¦ï¼Œæ‰èƒ½èµ°åˆ°ä¸‹ä¸€æ­¥ã€‚è€Œä¸”ååˆ†å®¹æ˜“é™·å…¥å±€éƒ¨æå°ç‚¹,å› æ­¤æˆ‘ä»¬ä½¿ç”¨SGDæ¥æ”¹å–„è¿™ä¸€ç°è±¡ã€‚<br>SGD ç®—æ³•çš„è¡¨è¾¾å¼å’ŒGDå·®ä¸å¤š:<br>$$x_{t+1}=x_t+\eta_t g_t$$<br>è¿™é‡Œ $g_t$ å°±æ˜¯æ‰€è°“çš„Stochastic Gradientï¼Œå®ƒæ»¡è¶³ $E[g_t]=-\nabla f(x_t)$ã€‚å®ƒå¯¹å¯¼æ•°çš„è¦æ±‚éå¸¸ä½ï¼Œå¯¼æ•°ç®—èµ·æ¥éå¸¸å¿«ã€‚ç”±äºæ•°æ®æ ·æœ¬ä¸­å­˜åœ¨å¤§é‡æ— ç”¨çš„å†—ä½™ä¿¡æ¯ï¼Œå› æ­¤ä½¿ç”¨éšæœºæ¢¯åº¦ä¸‹é™æ³•å¯ä»¥å¾—åˆ°è¿‘ä¼¼çš„ä¸‹é™æ¢¯åº¦ï¼Œè€Œä»…ä»…è¯è´¹å°‘é‡çš„è®¡ç®—èµ„æºã€‚<br><strong>softmax tensorflow å®ç°ç‰ˆæœ¬</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># downlown the data</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> tensorflow.examples.tutorials.mnist <span class="keyword">import</span> input_data</span><br><span class="line">mnist = input_data.read_data_sets(<span class="string">"MNIST_data/"</span>,one_hot=<span class="keyword">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># input data</span></span><br><span class="line">X = tf.placeholder(tf.float32,[<span class="keyword">None</span>,<span class="number">784</span>])</span><br><span class="line">Y = tf.placeholder(tf.float32,[<span class="keyword">None</span>,<span class="number">10</span>])</span><br><span class="line"><span class="comment"># model variable</span></span><br><span class="line">W = tf.Variable(tf.zeros([<span class="number">784</span>,<span class="number">10</span>]))</span><br><span class="line">b = tf.Variable(tf.zeros([<span class="number">10</span>]))</span><br><span class="line"><span class="comment"># define model</span></span><br><span class="line">y_predict = tf.matmul(X,W) + b</span><br><span class="line"></span><br><span class="line">cross_entropy = tf.reduce_mean(tf.nn.softmax_cross_entropy_with_logits(labels=Y,logits=y_predict))</span><br><span class="line">optimizer = tf.train.GradientDescentOptimizer(<span class="number">0.5</span>)</span><br><span class="line">train_step = optimizer.minimize(cross_entropy)</span><br><span class="line"></span><br><span class="line">sess = tf.InteractiveSession()</span><br><span class="line">global_initial = tf.global_variables_initializer()</span><br><span class="line">sess.run(global_initial)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1000</span>):</span><br><span class="line">    batch = mnist.train.next_batch(<span class="number">100</span>)</span><br><span class="line">    sess.run(train_step,feed_dict=&#123;X:batch[<span class="number">0</span>],Y:batch[<span class="number">1</span>]&#125;)</span><br><span class="line">correct_prediction = tf.equal(tf.argmax(y_predict,<span class="number">1</span>),tf.argmax(Y,<span class="number">1</span>))</span><br><span class="line">accuracy = tf.reduce_mean(tf.cast(correct_prediction,tf.float32))</span><br><span class="line">print(sess.run(accuracy,feed_dict=&#123;X:mnist.test.images,Y:mnist.test.labels&#125;))</span><br><span class="line"></span><br><span class="line">print(sess.run(b))</span><br></pre></td></tr></table></figure></p>
</div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>æœ¬æ–‡ä½œè€…ï¼š</strong>WenHui Zhou</li><li class="post-copyright-link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="/2019/02/20/cross-entropy-äº¤å‰ç†µä»¥åŠsoftmax/">https://wenhui-zhou.github.io/2019/02/20/cross-entropy-äº¤å‰ç†µä»¥åŠsoftmax/</a></li><li class="post-copyright-license"><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>| æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="&quot;http://creativecommons.org/licenses/by-nc-sa/3.0/cn/&quot;" rel="&quot;external" nofollow&quot;="" target="&quot;_blank&quot;">CC BY-NC-SA 3.0 CN</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼ </li></ul></div><br><div class="tags"><a href="/tags/æ·±åº¦å­¦ä¹ /">æ·±åº¦å­¦ä¹ </a></div><div class="post-nav"><a class="pre" href="/2019/02/20/è¯­ä¹‰åˆ†å‰²ç³»åˆ—-FCNè¯¦è§£/">è¯­ä¹‰åˆ†å‰²ç³»åˆ— -- FCNè¯¦è§£</a><a class="next" href="/2019/02/20/LeetCode-é¢˜è§£/">LeetCode é¢˜è§£(æŒç»­æ›´æ–°)</a></div><div id="vcomment"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script><script>var notify = 'false' == true ? true : false;
var verify = 'false' == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'civq9nKD49NpRALooR9Llqmf-gzGzoHsz',
  appKey:'JggO9HaSi1Lfx17nt16oDfsI',
  placeholder:'Shall we talk',
  avatar:'mm',
  guest_info:guest_info,
  pageSize:'10'
})</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> åˆ†ç±»</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Mac/">Mac</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tensorflow/">Tensorflow</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/super-resolution/">super resolution</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/tool/">tool</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/xigua/">xigua</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/å»ºç«™/">å»ºç«™</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/æ‰‹æ’•ç³»åˆ—/">æ‰‹æ’•ç³»åˆ—</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/æ¨¡å‹è¯„ä»·/">æ¨¡å‹è¯„ä»·</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/æ¯”èµ›/">æ¯”èµ›</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ç¼–ç¨‹/">ç¼–ç¨‹</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/è®ºæ–‡å¤ç°/">è®ºæ–‡å¤ç°</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/è®ºæ–‡é˜…è¯»/">è®ºæ–‡é˜…è¯»</a><span class="category-list-count">20</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/é¡¹ç›®/">é¡¹ç›®</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/é¡¹ç›®æ€»ç»“/">é¡¹ç›®æ€»ç»“</a><span class="category-list-count">4</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/é¡¹ç›®æ€»ç»“/è®ºæ–‡é˜…è¯»/">è®ºæ–‡é˜…è¯»</a><span class="category-list-count">3</span></li></ul></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> æ ‡ç­¾</i></div><div class="tagcloud"><a href="/tags/interview/" style="font-size: 15px;">interview</a> <a href="/tags/æ·±åº¦å­¦ä¹ /" style="font-size: 15px;">æ·±åº¦å­¦ä¹ </a> <a href="/tags/c/" style="font-size: 15px;">c++</a> <a href="/tags/leetcode/" style="font-size: 15px;">leetcode</a> <a href="/tags/netStation/" style="font-size: 15px;">netStation</a> <a href="/tags/tool/" style="font-size: 15px;">tool</a> <a href="/tags/dialog/" style="font-size: 15px;">dialog</a> <a href="/tags/tip/" style="font-size: 15px;">tip</a> <a href="/tags/Tensorflow/" style="font-size: 15px;">Tensorflow</a> <a href="/tags/tips/" style="font-size: 15px;">tips</a> <a href="/tags/â€”-leetcode/" style="font-size: 15px;">â€” leetcode</a> <a href="/tags/ç®—æ³•/" style="font-size: 15px;">ç®—æ³•</a> <a href="/tags/è®ºæ–‡é˜…è¯»/" style="font-size: 15px;">è®ºæ–‡é˜…è¯»</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> æœ€è¿‘æ–‡ç« </i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/08/22/å †æ’åºï¼Œpythonå®ç°/">å †æ’åºï¼Œpythonå®ç°</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/08/16/æ·±åº¦å­¦ä¹ ä»£ç çš„æ¡†æ¶/">æ·±åº¦å­¦ä¹ ä»£ç çš„æ¡†æ¶</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/24/normalization/">normalization</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/23/image-upsample-downsample-method/">image upsample-downsample method</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/23/Deep-Learning-for-image-Super-resolution-a-Survey/">Deep Learning for image Super-resolution: a Survey</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/23/ä¸€äº›æå‡æ•ˆç‡çš„æ–¹æ³•/">ä¸€äº›æå‡æ•ˆç‡çš„æ–¹æ³•</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/21/xigua-æ”¯æŒå‘é‡æœº/">xigua-æ”¯æŒå‘é‡æœº</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/20/xigua-ç¥ç»ç½‘ç»œ/">xigua-ç¥ç»ç½‘ç»œ</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/19/19-7-2019-preview/">19/7/2019 preview</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/17/å‰ç¼€æ ‘ğŸŒ²-trie/">å‰ç¼€æ ‘ğŸŒ²:trie</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> å‹æƒ…é“¾æ¥</i></div><ul></ul><a href="https://github.com/WenHui-Zhou" title="GITHUB" target="_blank">GITHUB</a><ul></ul><a href="http://www.google.com/" title="GOOGLE" target="_blank">GOOGLE</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright Â© 2019 <a href="/." rel="nofollow">WenHuiZhou.</a> è®¿é—®äººæ•°:<span id="busuanzi_value_site_uv"></span> 
è®¿é—®é‡:<span id="busuanzi_value_site_pv"></span></div><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> </div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.css"><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
  });
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML" async></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>