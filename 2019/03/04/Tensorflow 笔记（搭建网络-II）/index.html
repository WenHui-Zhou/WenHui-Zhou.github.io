<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="cheer up"><meta name="baidu-site-verification" content="9pSIuwCbvi"><meta name="google-site-verification" content="YzcCTjF6VoVlNAtL37_S4vFjzFwYTAFZzD51Il2IGKY"><title>Tensorflow ç¬”è®°ï¼ˆæ­å»ºç½‘ç»œ-IIï¼‰ | WenHuiZhou</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.3.1/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Tensorflow ç¬”è®°ï¼ˆæ­å»ºç½‘ç»œ-IIï¼‰</h1><a id="logo" href="/.">WenHuiZhou</a><p class="description">perperï¼ˆæ‰“èµ·ç²¾ç¥ï¼ï¼‰</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> é¦–é¡µ</i></a><a href="/archives/"><i class="fa fa-archive"> å½’æ¡£</i></a><a href="/about/"><i class="fa fa-user"> å…³äº</i></a><a href="/atom.xml"><i class="fa fa-rss"> è®¢é˜…</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Tensorflow ç¬”è®°ï¼ˆæ­å»ºç½‘ç»œ-IIï¼‰</h1><div class="post-meta">Mar 4, 2019<span> | </span><span class="category"><a href="/categories/Tensorflow/">Tensorflow</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> é˜…è¯»</span></span></div><a class="disqus-comment-count" href="/2019/03/04/Tensorflow ç¬”è®°ï¼ˆæ­å»ºç½‘ç»œ-IIï¼‰/#vcomment"><span class="valine-comment-count" data-xid="/2019/03/04/Tensorflow ç¬”è®°ï¼ˆæ­å»ºç½‘ç»œ-IIï¼‰/"></span><span> æ¡è¯„è®º</span></a><div class="post-content"><p>æœ¬ç¯‡æ–‡ç« ä¸»è¦è®²ç½‘ç»œæ­å»ºè¿‡ç¨‹ä¸­çš„ä»£ç ä»¥åŠæ³¨æ„è¦ç‚¹ã€‚<br><a id="more"></a></p>
<h3 id="æ·»åŠ ç½‘ç»œå±‚"><a href="#æ·»åŠ ç½‘ç»œå±‚" class="headerlink" title="æ·»åŠ ç½‘ç»œå±‚"></a>æ·»åŠ ç½‘ç»œå±‚</h3><p>å®šä¹‰ç½‘ç»œç»“æ„ï¼Œç„¶åå°†ç½‘ç»œå±‚æ·»åŠ åˆ°ç¥ç»ç½‘ç»œä¸­ã€‚å®šä¹‰ç½‘ç»œå±‚çš„ä¸»è¦æ­¥éª¤æœ‰ï¼š</p>
<ul>
<li>ç¡®å®šç½‘ç»œçš„å‚æ•°ï¼š<strong>è¾“å…¥ï¼Œè¾“å…¥çš„sizeï¼Œè¾“å‡ºçš„sizeï¼Œæ¿€åŠ±å‡½æ•°</strong></li>
<li>å®šä¹‰weightï¼Œbiases</li>
<li>è®¡ç®—output</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add_layer</span><span class="params">(input,in_size,out_size,activation_function = None)</span>:</span></span><br><span class="line">    Weights = tf.Variable(tf.random.normal([in_size,out_size]))</span><br><span class="line">    biases = tf.Variable(tf.zeros([<span class="number">1</span>,out_size])+<span class="number">0.01</span>)</span><br><span class="line">    Wx_plus_b = tf.matmul(input,Weights)+biases</span><br><span class="line">    <span class="keyword">if</span> activation_function <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">        output = Wx_plus_b</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        output = activation_function(Wx_bias_b)</span><br><span class="line">    <span class="keyword">return</span> output</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡ºæ¥ï¼Œç½‘ç»œå±‚ç¥ç»å…ƒçš„ä¸ªæ•°å³ä¸ºè¾“å‡ºçš„outsizeçš„å¤§å°ã€‚</p>
<h3 id="æ­å»ºç¥ç»ç½‘ç»œ"><a href="#æ­å»ºç¥ç»ç½‘ç»œ" class="headerlink" title="æ­å»ºç¥ç»ç½‘ç»œ"></a>æ­å»ºç¥ç»ç½‘ç»œ</h3><p>ä»¥ä¸‹ä¸ºæ­å»ºä¸€ä¸ªä¸‰å±‚ç¥ç»ç½‘ç»œï¼Œå…¶ä¸­è¾“å…¥å±‚ä¸º1ä¸ªç¥ç»å…ƒï¼Œè¾“å‡ºå±‚ä¸º1ä¸ªç¥ç»å…ƒï¼Œéšè—å±‚ä¸º10ä¸ªç¥ç»å…ƒã€‚æ­å»ºç½‘ç»œæ˜¯éœ€è¦å®Œæˆçš„äº‹æƒ…ä¸ºï¼š</p>
<ol>
<li>å®šä¹‰æ•°æ®ï¼Œç½‘ç»œå±‚ä¸­çš„å‚æ•°ç»´åº¦</li>
<li>å®šä¹‰ä¼ å…¥çš„å‚æ•°placeholderï¼Œlossï¼Œoptimizerç­‰</li>
<li>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ•°æ®çš„ç»´åº¦å˜åŒ–éœ€è¦ååˆ†æ³¨æ„</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># create data</span></span><br><span class="line">x_data = np.linspace(<span class="number">-1</span>,<span class="number">1</span>,<span class="number">300</span>)[:,np.newaxis]</span><br><span class="line">noise = np.random.rand(x_data.shape[<span class="number">0</span>],x_data.shape[<span class="number">1</span>])</span><br><span class="line">y_GT = np.square(x_data)+<span class="number">0.5</span>+noise</span><br><span class="line"></span><br><span class="line"><span class="comment"># placeholder</span></span><br><span class="line">xs = tf.placeholder(tf.float32,[<span class="keyword">None</span>,<span class="number">1</span>]) <span class="comment">#è¡¨ç¤ºæ ·æœ¬æ•°ï¼Œå’Œæ¯ä¸ªæ ·æœ¬çš„ç»´åº¦ä¸º1</span></span><br><span class="line">ys = tf.placeholder(tf.float32,[<span class="keyword">None</span>,<span class="number">1</span>])</span><br><span class="line"><span class="comment"># structure</span></span><br><span class="line">l1 = add_layer(ms,<span class="number">1</span>,<span class="number">10</span>,tf.nn.relu)</span><br><span class="line">output = add_layer(l2,<span class="number">10</span>,<span class="number">1</span>,<span class="keyword">None</span>)</span><br><span class="line"><span class="comment"># loss</span></span><br><span class="line">loss = tf.reduce_mean(tf.reduce_sum(tf.square(output-ys),<span class="number">1</span>))</span><br><span class="line">optimizer = tf.train.GrandientDescentOptimizer(<span class="number">0.1</span>).minimize(loss)</span><br><span class="line"></span><br><span class="line"><span class="comment">#train</span></span><br><span class="line">init = tf.global_variables_initializer()</span><br><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">    sess.run(init)</span><br><span class="line">    <span class="keyword">for</span> step <span class="keyword">in</span> range(<span class="number">1000</span>):</span><br><span class="line">        sess.run(optimizer,feed_dict=&#123;xs:x_data,ys:y_GT&#125;)</span><br><span class="line">        <span class="keyword">if</span> step%<span class="number">20</span> == <span class="number">0</span>:</span><br><span class="line">            print(loss,feed_dict=&#123;xs:x_data,ys:y_GT&#125;)</span><br></pre></td></tr></table></figure>
<p><strong>ä»£ç è¯¦è§£å¦‚ä¸‹ï¼š</strong></p>
<ol>
<li><p><code>x_data = np.linspace(-1,1,300)[:,np.newaxis]</code>ï¼šå…¶ä¸­<code>np.linspace(-1,1)</code>ç”Ÿæˆ-1ï¼Œåˆ°1ä¹‹é—´çš„300ä¸ªæ•°ã€‚<code>[:,np.newaxis]</code>æŒ‡å°†ç”Ÿæˆçš„æ•°æ®ç»´åº¦æå‡ã€‚åŸæ¥æ˜¯1x300ï¼Œç°åœ¨æ˜¯300x1ï¼Œç”±1ä¸ºå˜ä¸º300ç»´ï¼Œæ¯ä¸ªæ•°æ®å ä¸€ä¸ªç»´åº¦ã€‚</p>
</li>
<li><p><code>xs = tf.placeholder(tf.float32,[None,1]) #è¡¨ç¤ºæ ·æœ¬æ•°ï¼Œå’Œæ¯ä¸ªæ ·æœ¬çš„ç»´åº¦ä¸º1</code>ï¼šå…¶ä¸­<code>[None,1]</code>æœ‰ä¸€ç§å«ä¹‰ä¸ºï¼Œå½“ä½ ä¸çŸ¥é“æ ·æœ¬æ•°çš„æ—¶å€™ï¼ŒæŠ“ä½æ¯ä¸ªæ ·æœ¬çš„ç»´åº¦å³å¯ã€‚</p>
</li>
<li><code>tf.reduce_sum(tf.square(output-ys),1)</code>: å…¶ä¸­<code>tf.reduce_sum()</code>è¿™ä¸ªå‡½æ•°ä¸ºæ±‚å’Œå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ª<strong>æ•°ç»„</strong>ï¼Œç¬¬äºŒä¸ªå‚æ•°é»˜è®¤åˆ™ä¸º<strong>æ‰€æœ‰æ•°ä¹‹å’Œ</strong>ã€‚ç¬¬äºŒä¸ªå‚æ•°ä¸º0ï¼Œåˆ™ä¸º<strong>åˆ—ä¹‹å’Œï¼ˆ0ï¼‰</strong>ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸º1åˆ™ä¸º<strong>è¡Œä¹‹å’Œï¼ˆ1ï¼‰</strong>ã€‚<code>tf.reduce_mean()</code>å‚æ•°å«ä¹‰ä¸æ±‚å’Œå‡½æ•°ä¸€è‡´ã€‚</li>
<li>åœ¨å†™ç½‘ç»œç»“æ„çš„æ—¶å€™ï¼Œç”¨placeholderï¼Œæš‚æ—¶å¿˜è®°æ‰çœŸå®çš„æ•°æ®ï¼Œå…ˆæ„å»ºå¥½æ¡†æ¶åï¼Œç„¶åä¼ å…¥å‚æ•°ã€‚</li>
</ol>
<h3 id="ç»“æœå¯è§†åŒ–"><a href="#ç»“æœå¯è§†åŒ–" class="headerlink" title="ç»“æœå¯è§†åŒ–"></a>ç»“æœå¯è§†åŒ–</h3><p>å¯è§†åŒ–æ¨¡å—ä¸€èˆ¬ä½¿ç”¨<code>matplotlib.plot as plt</code> æ¥ç»˜å›¾ã€‚</p>
<p><strong>matplotlibçš„å±‚æ¬¡ç»“æ„ï¼š</strong><br>matplotlibçš„ç»“æ„ç±»ä¼¼ä¸ä¸€ä¸ªæ ‘çŠ¶ç»“æ„ã€‚<code>Figure</code> : ä¸ºå±‚æ¬¡ç»“æ„ä¸­çš„æœ€å¤–å±‚ï¼Œå†…éƒ¨å¯åŒ…å«å¤šå¼ plotå›¾åƒã€‚plotå›¾å±‚æ¬¡ç»“æ„å¯åŒ…å«çš„å¯¹è±¡ä¾‹å¦‚åˆ»åº¦çº¿ï¼Œå•ç‹¬çš„çº¿æ¡ï¼Œå›¾ä¾‹å’Œæ–‡æœ¬æ¡†ã€‚å‡ ä¹æ¯ä¸ªâ€œå…ƒç´ â€éƒ½æ˜¯ä¸€ä¸ªPythonå¯¹è±¡ã€‚å…·ä½“ä»£ç å®ç°å¦‚ä¸‹ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">x = np.linspace(-np.pi,np.pi,<span class="number">300</span>)</span><br><span class="line">xsin = np.sin(x)</span><br><span class="line">xcos = np.cos(x)</span><br><span class="line">plt.subplot(<span class="number">221</span>) <span class="comment"># è¡¨æ˜å…±æœ‰2åˆ—ï¼Œ2è¡Œçš„å›¾ç‰‡è¦ç”»ï¼Œç°åœ¨æ‹¿åˆ°ç¬¬ä¸€ä¸ªæ¥ç”»</span></span><br><span class="line">plt.plot(x,xsin) <span class="comment"># è¦ç”»æŠ˜çº¿å›¾ï¼Œå¦‚æœç‚¹å¾ˆå¯†é›†ï¼Œå°±æ˜¯æ›²çº¿å›¾</span></span><br><span class="line">plt.xlabel(<span class="string">'xè½´'</span>) <span class="comment"># æ‰€æœ‰å±äºè¿™ä¸ªå­å›¾çš„å°å¯¹è±¡ï¼Œå¦‚é¢œè‰²ï¼Œå›¾ä¾‹ï¼Œéƒ½å¯ä»¥ä¿®æ”¹</span></span><br><span class="line">plt.subplot(<span class="number">222</span>) <span class="comment"># è¡¨æ˜2åˆ—2è¡Œï¼Œç°åœ¨è¦ç”»ç¬¬äºŒä¸ª</span></span><br><span class="line">plt.plot(x,xcos)</span><br><span class="line">plt.subplot(<span class="number">223</span>) <span class="comment"># è¡¨æ˜2è¡Œ2åˆ—ï¼Œç°åœ¨è¦ç”»ç¬¬ä¸‰ä¸ª</span></span><br><span class="line">plt.scatter(x,xsin) <span class="comment"># è¦ç”»æ•£ç‚¹å›¾</span></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure></p>
<p>å¦‚ä¸Šï¼Œæ¯æ¬¡ä½¿ç”¨<code>plt.subplot(xxx)</code>äº¤æ¢æ§åˆ¶çš„å­å›¾ï¼Œéå¸¸å¥½æ‡‚å“ˆå“ˆå“ˆã€‚</p>
<p>ä¸‹é¢æ˜¯æ­å»ºç½‘ç»œï¼Œç»˜åˆ¶æ‹Ÿåˆå›¾çš„å®Œæ•´ä»£ç ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.environ[<span class="string">'KMP_DUPLICATE_LIB_OK'</span>]=<span class="string">'True'</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">æ·»åŠ å±‚éœ€è¦è€ƒè™‘çš„å› ç´ æœ‰å‡ ä¸ªï¼Œé¦–å…ˆè¾“å…¥çš„æ•°æ®ï¼Œè¾“å…¥çš„æ•°æ®å°ºåº¦ï¼Œè¾“å‡ºçš„å°ºåº¦ï¼ˆç¥ç»å…ƒä¸ªæ•°ï¼‰ï¼Œæ¿€æ´»å‡½æ•°</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add_layer</span><span class="params">(input,in_size,out_size,activation_function = None)</span>:</span></span><br><span class="line">    <span class="comment">#å®šä¹‰æƒé‡</span></span><br><span class="line">    Weights = tf.Variable(tf.random.normal([in_size,out_size]))</span><br><span class="line">    bias = tf.Variable(tf.zeros([<span class="number">1</span>,out_size])+ <span class="number">0.01</span>)</span><br><span class="line">    Wx_plus_b = tf.matmul(input,Weights) + bias</span><br><span class="line">    <span class="keyword">if</span> activation_function <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">        outputs = Wx_plus_b</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        outputs = activation_function(Wx_plus_b)</span><br><span class="line">    <span class="keyword">return</span> outputs</span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">æ„å»ºç¥ç»ç½‘ç»œï¼š</span></span><br><span class="line"><span class="string">1. æ­å»ºä¸€ä¸ªè¾“å…¥å±‚ä»…æœ‰ä¸€ä¸ªç¥ç»å…ƒï¼Œéšè—å±‚10ä¸ªç¥ç»å…ƒï¼Œè¾“å‡ºå±‚1ä¸ªç¥ç»å…ƒçš„ç½‘ç»œ</span></span><br><span class="line"><span class="string">2. éœ€è¦å®šä¹‰æ•°æ®ï¼Œç½‘ç»œå±‚ï¼Œè¾“å…¥è¾“å‡ºï¼Œplaceholderï¼Œloss ï¼Œoptimizer</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="comment"># np.linspace(-1,1,10)[:,np.newaxis],å¼•å…¥æ–°ç»´åº¦</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># create data</span></span><br><span class="line"></span><br><span class="line">x_data = np.linspace(<span class="number">-1</span>,<span class="number">1</span>,<span class="number">300</span>)[:,np.newaxis]</span><br><span class="line"></span><br><span class="line">noise = np.random.rand(<span class="number">300</span>,<span class="number">1</span>)</span><br><span class="line">y_GT = np.square(x_data) + <span class="number">0.5</span>+noise</span><br><span class="line"></span><br><span class="line"><span class="comment"># create network</span></span><br><span class="line"></span><br><span class="line">xs = tf.placeholder(tf.float32,x_data.shape)</span><br><span class="line">ys = tf.placeholder(tf.float32,y_GT.shape)</span><br><span class="line"></span><br><span class="line">l1 = add_layer(xs,<span class="number">1</span>,<span class="number">10</span>,activation_function=tf.nn.relu)</span><br><span class="line">output = add_layer(l1,<span class="number">10</span>,<span class="number">1</span>,activation_function=<span class="keyword">None</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># loss</span></span><br><span class="line">loss = tf.reduce_mean(tf.reduce_sum(tf.square(output-ys),<span class="number">1</span>))</span><br><span class="line">optimizer = tf.train.GradientDescentOptimizer(<span class="number">0.1</span>).minimize(loss)</span><br><span class="line"></span><br><span class="line"><span class="comment">#illustration</span></span><br><span class="line">ax = plt.subplot(<span class="number">111</span>)</span><br><span class="line">plt.scatter(x_data,y_GT)</span><br><span class="line"></span><br><span class="line">plt.ion() <span class="comment"># åŠ¨æ€ç”»å›¾ï¼Œä¸åœæ­¢</span></span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># train</span></span><br><span class="line"></span><br><span class="line">init = tf.global_variables_initializer()</span><br><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">    sess.run(init)</span><br><span class="line">    <span class="keyword">for</span> step <span class="keyword">in</span> range(<span class="number">500</span>):</span><br><span class="line">        sess.run(optimizer,feed_dict=&#123;xs:x_data,ys:y_GT&#125;)</span><br><span class="line">        <span class="keyword">if</span> step%<span class="number">20</span> == <span class="number">0</span>:</span><br><span class="line">            print(sess.run(loss,feed_dict=&#123;xs:x_data,ys:y_GT&#125;))</span><br><span class="line">            predict = sess.run(output,feed_dict=&#123;xs:x_data&#125;)</span><br><span class="line">        <span class="comment">#    plt.plot(x_data,predict)</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                ax.lines.remove(lines[<span class="number">0</span>])</span><br><span class="line">            <span class="keyword">except</span> Exception:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># plot the prediction</span></span><br><span class="line">            lines = plt.plot(x_data, predict, <span class="string">'r-'</span>, lw=<span class="number">5</span>)</span><br><span class="line">            plt.pause(<span class="number">0.5</span>)</span><br></pre></td></tr></table></figure></p>
<h3 id="TensorBoard-å¯è§†åŒ–"><a href="#TensorBoard-å¯è§†åŒ–" class="headerlink" title="TensorBoard å¯è§†åŒ–"></a>TensorBoard å¯è§†åŒ–</h3><p>Tensorboard ä½œä¸ºtensorflowç½‘ç»œç»“æœå¯è§†åŒ–çš„ä¸€ä¸ªæ¯”è¾ƒå¥½çš„å·¥å…·ï¼Œä»–ä½¿ç”¨<code>tf.name_scope(&quot;name&quot;):</code>çš„æ–¹å¼å¯¹éƒ¨åˆ†å…ƒä»¶è¿›è¡Œæ•´ä½“çš„å‘½åã€‚å¹¶ä¸”æ”¯æŒå¤šå±‚çš„åµŒå¥—ã€‚å¦‚ä¸‹ä¾‹å­ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> tf.name_scope(<span class="string">"layer"</span>):</span><br><span class="line">    <span class="keyword">with</span> tf.name_scope(<span class="string">"Weight"</span>):</span><br><span class="line">        Weights = tf.Variable(tf.random.normal([<span class="number">300</span>,<span class="number">1</span>]),name = <span class="string">'W'</span>)</span><br></pre></td></tr></table></figure>
<p>tensorboardå·¥ä½œçš„æ€è·¯æ˜¯å°†æ–‡ä»¶å†™å…¥ç£ç›˜ï¼Œç„¶åç”±æµè§ˆå™¨è¿›è¡Œè®¿é—®ï¼Œå†™å…¥ç£ç›˜çš„è¯­å¥å¦‚ä¸‹ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sess = tf.Session()</span><br><span class="line">writer = tf.summary.FileWriter(<span class="string">'./log'</span>,sess.graph)</span><br></pre></td></tr></table></figure>
<p>æœ€ååœ¨å‘½ä»¤è¡Œä¸­ï¼Œè¿›å…¥æ–‡ä»¶ç›®å½•è¾“å…¥æŒ‡ä»¤ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tensorboard --logdir = 'log/'</span><br></pre></td></tr></table></figure>
<p>éšååœ¨æµè§ˆå™¨ä¸­è¾“å…¥ï¼š<code>0.0.0.0:6006</code>å³å¯é¢„è§ˆã€‚</p>
<p>tensorboardè¿˜å¯ä»¥ç›‘æ§å•ä¸ªå˜é‡çš„å˜åŒ–æƒ…å†µï¼Œä½¿ç”¨histogramç›´æ–¹å›¾æ¥æ˜¾ç¤ºã€‚<code>tf.summary.histogram</code>ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> tf.name_scope(<span class="string">"Weight"</span>):</span><br><span class="line">    Weights = tf.Variable(tf.random.normal([<span class="number">300</span>,<span class="number">1</span>]),name = <span class="string">'W'</span>)</span><br><span class="line">    tf.summary.histogram(name,Weight)</span><br></pre></td></tr></table></figure>
<p>tensorboardçœ‹ä¸€ä¸ªä¸€ç»´çš„å˜é‡ï¼Œå¦‚lossï¼Œä½¿ç”¨<code>tf.summary.scalar</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> tf.name_scope(<span class="string">'loss'</span>):</span><br><span class="line">    loss = tf.reduce.mean(tf.reduce.sum(tf.square(y-p_pred),<span class="number">1</span>),<span class="number">1</span>)</span><br><span class="line">    tf.summary.scalar(<span class="string">'loss'</span>,loss)</span><br></pre></td></tr></table></figure>
<p>æœ€åéœ€è¦å¯¹æ‰€æœ‰çš„summaryè¿›è¡Œèåˆï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">merged = tf.summary.merge_all()</span><br></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥åœ¨è®­ç»ƒçš„æ—¶å€™æ›´æ–°å‚æ•°,ç„¶åä½¿ç”¨<code>writer.add_summary(result,step)</code>æ¥å°†summaryå†™å…¥æ–‡ä»¶ä¸­ã€‚</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">init = tf.global_variables_initializer()</span><br><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">    sess.run(init)</span><br><span class="line">    <span class="keyword">for</span> step <span class="keyword">in</span> range(<span class="number">1000</span>):</span><br><span class="line">        sess.run(optimizer,feed_dict=&#123;xs:x_data,ys:y_GT&#125;)</span><br><span class="line">        <span class="keyword">if</span> step%<span class="number">20</span> == <span class="number">0</span>:</span><br><span class="line">            result = sess.run(merged,feed_dict=&#123;xs:x_data,ys:y_GT&#125;)</span><br><span class="line">            writer.add_summary(result,step)</span><br></pre></td></tr></table></figure>
<p>æ¥ç€ä½¿ç”¨å‘½ä»¤è¡Œè¿è¡Œå³å¯.x</p>
</div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>æœ¬æ–‡ä½œè€…ï¼š</strong>WenHui Zhou</li><li class="post-copyright-link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="/2019/03/04/Tensorflow ç¬”è®°ï¼ˆæ­å»ºç½‘ç»œ-IIï¼‰/">https://wenhui-zhou.github.io/2019/03/04/Tensorflow ç¬”è®°ï¼ˆæ­å»ºç½‘ç»œ-IIï¼‰/</a></li><li class="post-copyright-license"><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>| æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="&quot;http://creativecommons.org/licenses/by-nc-sa/3.0/cn/&quot;" rel="&quot;external" nofollow&quot;="" target="&quot;_blank&quot;">CC BY-NC-SA 3.0 CN</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼ </li></ul></div><br><div class="tags"><a href="/tags/Tensorflow/">Tensorflow</a></div><div class="post-nav"><a class="pre" href="/2019/03/04/MobileNet-V2-è¯¦è§£/">MobileNet V2 è¯¦è§£</a><a class="next" href="/2019/03/03/MobileNets-è¯¦è§£/">MobileNets è¯¦è§£</a></div><div id="vcomment"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script><script>var notify = 'false' == true ? true : false;
var verify = 'false' == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'civq9nKD49NpRALooR9Llqmf-gzGzoHsz',
  appKey:'JggO9HaSi1Lfx17nt16oDfsI',
  placeholder:'Shall we talk',
  avatar:'mm',
  guest_info:guest_info,
  pageSize:'10'
})</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> åˆ†ç±»</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Mac/">Mac</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tensorflow/">Tensorflow</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/super-resolution/">super resolution</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/tool/">tool</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/xigua/">xigua</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/å»ºç«™/">å»ºç«™</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/æ‰‹æ’•ç³»åˆ—/">æ‰‹æ’•ç³»åˆ—</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/æ¨¡å‹è¯„ä»·/">æ¨¡å‹è¯„ä»·</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/æ¯”èµ›/">æ¯”èµ›</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ç¼–ç¨‹/">ç¼–ç¨‹</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/è®ºæ–‡å¤ç°/">è®ºæ–‡å¤ç°</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/è®ºæ–‡é˜…è¯»/">è®ºæ–‡é˜…è¯»</a><span class="category-list-count">20</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/é¡¹ç›®/">é¡¹ç›®</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/é¡¹ç›®æ€»ç»“/">é¡¹ç›®æ€»ç»“</a><span class="category-list-count">4</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/é¡¹ç›®æ€»ç»“/è®ºæ–‡é˜…è¯»/">è®ºæ–‡é˜…è¯»</a><span class="category-list-count">3</span></li></ul></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> æ ‡ç­¾</i></div><div class="tagcloud"><a href="/tags/interview/" style="font-size: 15px;">interview</a> <a href="/tags/æ·±åº¦å­¦ä¹ /" style="font-size: 15px;">æ·±åº¦å­¦ä¹ </a> <a href="/tags/c/" style="font-size: 15px;">c++</a> <a href="/tags/leetcode/" style="font-size: 15px;">leetcode</a> <a href="/tags/netStation/" style="font-size: 15px;">netStation</a> <a href="/tags/tool/" style="font-size: 15px;">tool</a> <a href="/tags/dialog/" style="font-size: 15px;">dialog</a> <a href="/tags/tip/" style="font-size: 15px;">tip</a> <a href="/tags/Tensorflow/" style="font-size: 15px;">Tensorflow</a> <a href="/tags/tips/" style="font-size: 15px;">tips</a> <a href="/tags/â€”-leetcode/" style="font-size: 15px;">â€” leetcode</a> <a href="/tags/ç®—æ³•/" style="font-size: 15px;">ç®—æ³•</a> <a href="/tags/è®ºæ–‡é˜…è¯»/" style="font-size: 15px;">è®ºæ–‡é˜…è¯»</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> æœ€è¿‘æ–‡ç« </i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/08/22/å †æ’åºï¼Œpythonå®ç°/">å †æ’åºï¼Œpythonå®ç°</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/08/16/æ·±åº¦å­¦ä¹ ä»£ç çš„æ¡†æ¶/">æ·±åº¦å­¦ä¹ ä»£ç çš„æ¡†æ¶</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/24/normalization/">normalization</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/23/image-upsample-downsample-method/">image upsample-downsample method</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/23/Deep-Learning-for-image-Super-resolution-a-Survey/">Deep Learning for image Super-resolution: a Survey</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/23/ä¸€äº›æå‡æ•ˆç‡çš„æ–¹æ³•/">ä¸€äº›æå‡æ•ˆç‡çš„æ–¹æ³•</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/21/xigua-æ”¯æŒå‘é‡æœº/">xigua-æ”¯æŒå‘é‡æœº</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/20/xigua-ç¥ç»ç½‘ç»œ/">xigua-ç¥ç»ç½‘ç»œ</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/19/19-7-2019-preview/">19/7/2019 preview</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/17/å‰ç¼€æ ‘ğŸŒ²-trie/">å‰ç¼€æ ‘ğŸŒ²:trie</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> å‹æƒ…é“¾æ¥</i></div><ul></ul><a href="https://github.com/WenHui-Zhou" title="GITHUB" target="_blank">GITHUB</a><ul></ul><a href="http://www.google.com/" title="GOOGLE" target="_blank">GOOGLE</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright Â© 2019 <a href="/." rel="nofollow">WenHuiZhou.</a> è®¿é—®äººæ•°:<span id="busuanzi_value_site_uv"></span> 
è®¿é—®é‡:<span id="busuanzi_value_site_pv"></span></div><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> </div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.css"><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
  });
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML" async></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>