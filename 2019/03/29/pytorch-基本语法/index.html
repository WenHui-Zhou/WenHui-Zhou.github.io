<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="cheer up"><meta name="baidu-site-verification" content="9pSIuwCbvi"><meta name="google-site-verification" content="YzcCTjF6VoVlNAtL37_S4vFjzFwYTAFZzD51Il2IGKY"><title>pytorch åŸºæœ¬è¯­æ³• | WenHuiZhou</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.3.1/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">pytorch åŸºæœ¬è¯­æ³•</h1><a id="logo" href="/.">WenHuiZhou</a><p class="description">perperï¼ˆæ‰“èµ·ç²¾ç¥ï¼ï¼‰</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> é¦–é¡µ</i></a><a href="/archives/"><i class="fa fa-archive"> å½’æ¡£</i></a><a href="/about/"><i class="fa fa-user"> å…³äº</i></a><a href="/atom.xml"><i class="fa fa-rss"> è®¢é˜…</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">pytorch åŸºæœ¬è¯­æ³•</h1><div class="post-meta">Mar 29, 2019<span> | </span><span class="category"><a href="/categories/tool/">tool</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> é˜…è¯»</span></span></div><a class="disqus-comment-count" href="/2019/03/29/pytorch-åŸºæœ¬è¯­æ³•/#vcomment"><span class="valine-comment-count" data-xid="/2019/03/29/pytorch-åŸºæœ¬è¯­æ³•/"></span><span> æ¡è¯„è®º</span></a><div class="post-content"><p>æœ¬ç¯‡æ–‡ç« å°†è®°å½•pytorchä½¿ç”¨è¿‡ç¨‹ä¸­çš„ä¸€äº›å€¼å¾—è®°å½•çš„trickã€‚</p>
<a id="more"></a>
<h3 id="pytorch-åŸºæœ¬å·¥ä½œæµ"><a href="#pytorch-åŸºæœ¬å·¥ä½œæµ" class="headerlink" title="pytorch åŸºæœ¬å·¥ä½œæµ"></a>pytorch åŸºæœ¬å·¥ä½œæµ</h3><p>ã€0ã€‘å¼•å…¥å¿…è¦çš„åŒ…</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br></pre></td></tr></table></figure>
<p>ã€1ã€‘å‡†å¤‡æ•°æ®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = torch.tensor(<span class="number">1.</span>,requires_grad=<span class="keyword">True</span>)</span><br><span class="line">x = torch.randn(<span class="number">10</span>,<span class="number">3</span>) <span class="comment"># 10*3çš„çŸ©é˜µ</span></span><br><span class="line">y = torch.randn(<span class="number">10</span>,<span class="number">2</span>) <span class="comment"># 10*2</span></span><br></pre></td></tr></table></figure>
<p>ã€2ã€‘ç½‘ç»œæ­å»º</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®šä¹‰ç½‘ç»œå±‚ï¼Œç½‘ç»œè¾“å…¥è¾“å‡ºå‚æ•°ç­‰ç­‰ï¼Œä¸‹é¢ä½¿ç”¨pytorchå†…ç½®çš„å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">linear = nn.Linear(<span class="number">3</span>,<span class="number">2</span>) <span class="comment"># æ­å»ºä¸€ä¸ªè¾“å…¥channelä¸º3ï¼Œè¾“å‡ºchannelä¸º2çš„å…¨è¿æ¥ç½‘ç»œ</span></span><br><span class="line">print(linear.weight)    <span class="comment"># torchä»¥åŠæ›¿æˆ‘ä»¬å®šä¹‰å¥½äº†å‚æ•°</span></span><br><span class="line">print(linear.bias)</span><br></pre></td></tr></table></figure>
<p>ã€3ã€‘æŸå¤±å‡½æ•°ä»¥åŠä¼˜åŒ–å™¨</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">criterion = nn.MSELoss()</span><br><span class="line">optimizer = nn.optim.SGD(linear.parameters(),lr = <span class="number">0.01</span>)</span><br></pre></td></tr></table></figure>
<p>ã€4ã€‘ç½‘ç»œæ­£å‘ä¼ æ’­</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pred = linear(x)</span><br><span class="line"><span class="comment"># è®¡ç®—loss</span></span><br><span class="line">loss = criterion(pred,y)</span><br><span class="line">print(loss)</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸€ç‚¹å’Œtensorflowå¾ˆä¸ä¸€æ ·ï¼Œtensorflowè¦å…ˆæ­å»ºå¥½æ•´ä¸ªç½‘ç»œï¼Œç„¶åå°†æ•°æ®feedè¿›å»ï¼Œpytorchåˆ™æ˜¯åŠ¨æ€æ„å»ºç½‘ç»œå›¾ï¼Œè¾¹æ­å»ºç½‘ç»œè¾¹è¿›è¡Œä¼ å€¼ã€‚</p>
<p>ã€5ã€‘ç½‘ç»œåå‘ä¼ æ’­</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åå‘ä¼ æ’­</span></span><br><span class="line">loss.backward()</span><br><span class="line">print(<span class="string">'dl/dw'</span>,linear.weight.grad)</span><br><span class="line">print(<span class="string">'dl/db'</span>,linear.bias.grad)</span><br><span class="line"><span class="comment"># ä½¿ç”¨optimizerçš„æ–¹å¼æ›´æ–°å‚æ•°</span></span><br><span class="line">optimizer.step() <span class="comment"># ä¸€æ¬¡æ›´æ–°å‚æ•°</span></span><br><span class="line"></span><br><span class="line">pred = linear(x)</span><br><span class="line">loss = criterion(pred,y) <span class="comment">## é‡å¤ä¸Šè¯‰æ­¥éª¤ç›´åˆ°å®Œæˆå‚æ•°æ‹Ÿåˆ</span></span><br></pre></td></tr></table></figure>
<h3 id="torchä¸numpyç›¸äº’è½¬åŒ–"><a href="#torchä¸numpyç›¸äº’è½¬åŒ–" class="headerlink" title="torchä¸numpyç›¸äº’è½¬åŒ–"></a>torchä¸numpyç›¸äº’è½¬åŒ–</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"></span><br><span class="line">x = np.array([[<span class="number">3</span>,<span class="number">2</span>],[<span class="number">1</span>,<span class="number">4</span>]]) <span class="comment"># numpy.array</span></span><br><span class="line">y = torch.from_numpy(x)     <span class="comment"># torch.tensor</span></span><br><span class="line">z = y.numpy()               <span class="comment"># tensor to numpy</span></span><br></pre></td></tr></table></figure>
<h3 id="torch-å¯¼å…¥æ•°æ®çš„piplineï¼ˆæµç¨‹ï¼‰"><a href="#torch-å¯¼å…¥æ•°æ®çš„piplineï¼ˆæµç¨‹ï¼‰" class="headerlink" title="torch å¯¼å…¥æ•°æ®çš„piplineï¼ˆæµç¨‹ï¼‰"></a>torch å¯¼å…¥æ•°æ®çš„piplineï¼ˆæµç¨‹ï¼‰</h3><p>torchvisionæ˜¯torchä¸­ä¸€ä¸ªç”¨äº <strong>ç”Ÿæˆå›¾ç‰‡ï¼Œæ•°æ®é›†ï¼Œæ¨¡å‹ç±»ï¼Œæ¬²è®­ç»ƒæ¨¡å‹</strong>çš„åŒ…ã€‚å®ƒä¸»è¦åŒ…å«ä¸€ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š</p>
<ol>
<li><strong>torchvision.datasets</strong>:  ç”¨äºå¯¼å…¥ä¸€äº›æ¯”è¾ƒæµè¡Œçš„å¼€æºæ•°æ®é›†ï¼ˆcifarç­‰ï¼‰</li>
<li><strong>torchvision.models</strong>: åŒ…å«äº†å¾ˆå¤šæµè¡Œçš„ç½‘ç»œæ¡†æ¶ï¼ŒåŒ…æ‹¬alexnetï¼ŒVGGï¼Œresnetï¼Œä»¥åŠä¸€ä¸‹æ¬²è®­ç»ƒæ¨¡å‹</li>
<li><strong>torchvision.transforms</strong>: å®šä¹‰äº†ä¸€äº›å¸¸ç”¨çš„æ•°æ®é¢„å¤„ç†çš„å‡½æ•°ï¼Œå¦‚random cropï¼Œrotateç­‰ç­‰</li>
<li><strong>torchvision.utils</strong>: é‡Œå¤´å®šä¹‰äº†å¾ˆå¤šå¥½ç”¨çš„å‡½æ•°ï¼Œå¦‚ä¿å­˜å›¾ç‰‡ç­‰</li>
</ol>
<h3 id="torchvision-datasets-çš„ä½¿ç”¨"><a href="#torchvision-datasets-çš„ä½¿ç”¨" class="headerlink" title="torchvision.datasets çš„ä½¿ç”¨"></a>torchvision.datasets çš„ä½¿ç”¨</h3><p>ä¸‹è½½ï¼Œå¯¼å…¥æ•°æ®ï¼Œä»¥åŠæŒ‰ä¸€å®šçš„batchå–å‡ºæ•°æ®ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># get the dataset</span></span><br><span class="line">train_data = torchvision.datasets.CIFAR10(root=<span class="string">'.'</span>,train=<span class="keyword">True</span>,transform=torchvision.transforms.toTensor(),download = <span class="keyword">True</span>)</span><br><span class="line">image,label = train_data[<span class="number">0</span>]</span><br><span class="line"><span class="comment"># load data</span></span><br><span class="line">loader = torch.utils.data.Dataloader(dataset = train_data,batch_size = <span class="number">64</span>,shuffle=<span class="keyword">True</span>)</span><br><span class="line"><span class="comment">#æ¯æ¬¡load ä¸€ä¸ªå¤§å°ä¸º64çš„batchçš„æ•°æ®</span></span><br><span class="line">train_iter = iter(loader)</span><br><span class="line">image,label = train_iter.next()</span><br></pre></td></tr></table></figure>
<h3 id="pytorch-è®­ç»ƒministæ•°æ®é›†ä¸­çš„ä¸€äº›æ–¹æ³•"><a href="#pytorch-è®­ç»ƒministæ•°æ®é›†ä¸­çš„ä¸€äº›æ–¹æ³•" class="headerlink" title="pytorch è®­ç»ƒministæ•°æ®é›†ä¸­çš„ä¸€äº›æ–¹æ³•"></a>pytorch è®­ç»ƒministæ•°æ®é›†ä¸­çš„ä¸€äº›æ–¹æ³•</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## è¯»å–æ•°æ®</span></span><br><span class="line">train = torchvision.datasets.MNIST(root=<span class="string">'./'</span>,train=<span class="keyword">True</span>,transform=torchvision.transforms.ToTensor(),download = <span class="keyword">True</span>)</span><br><span class="line"><span class="comment"># data loader</span></span><br><span class="line">data_loader = torch.utils.data.DataLoader(dataset = train,batch_size = <span class="number">100</span>,shuffle = <span class="keyword">True</span>)</span><br><span class="line"><span class="keyword">for</span> image,label <span class="keyword">in</span> data_loader:</span><br><span class="line">  <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<h4 id="è®­ç»ƒé˜¶æ®µ"><a href="#è®­ç»ƒé˜¶æ®µ" class="headerlink" title="è®­ç»ƒé˜¶æ®µ"></a>è®­ç»ƒé˜¶æ®µ</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> num_epoch:</span><br><span class="line">  <span class="keyword">for</span> i ,(image,label) <span class="keyword">in</span> enumerate(train_loader):</span><br><span class="line">    output = model(image.reshape(<span class="number">-1</span>,<span class="number">28</span>*<span class="number">28</span>))</span><br><span class="line">    loss = criterion(output,label)</span><br><span class="line">    optimizer.zero_grad()  <span class="comment">#åˆ‡è®°ï¼Œåœ¨è®¡ç®—å¯¼æ•°å‰è¦å°†å¯¼æ•°ç½®é›¶</span></span><br><span class="line">    loss.backward()</span><br><span class="line">    optimizer.step()</span><br><span class="line">    <span class="keyword">if</span> i+<span class="number">1</span> == <span class="number">100</span>:</span><br><span class="line">      print(<span class="string">'epoch:&#123;&#125;/&#123;&#125;,step:&#123;&#125;/&#123;&#125;,loss:&#123;:.4f&#125;'</span>.format(epoch+<span class="number">1</span>,num_epochs,i+<span class="number">1</span>,total_step,loss))</span><br></pre></td></tr></table></figure>
<h4 id="æµ‹è¯•é˜¶æ®µ"><a href="#æµ‹è¯•é˜¶æ®µ" class="headerlink" title="æµ‹è¯•é˜¶æ®µ"></a>æµ‹è¯•é˜¶æ®µ</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸ç®—æ¢¯åº¦</span></span><br><span class="line"><span class="keyword">with</span> torch.no_grad():</span><br><span class="line">  correct = <span class="number">0</span></span><br><span class="line">  total = <span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span> image,label <span class="keyword">in</span> val_loader:</span><br><span class="line">    output = model(image.reshape(<span class="number">-1</span>,<span class="number">28</span>*<span class="number">28</span>))</span><br><span class="line">    _,predict = torch.max(output.data,<span class="number">1</span>)</span><br><span class="line">    total+= label.size(<span class="number">0</span>)</span><br><span class="line">    correct += (predict == label).sum().numpy()</span><br><span class="line">print(<span class="string">'accuracy: &#123;&#125;'</span>.format(correct/total))</span><br><span class="line">torch.save(model.state.dict,<span class="string">'model_param.ckpt'</span>)</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­<code>val,index = torch.max(matrix,1)</code>ï¼Œè®¡ç®—matrixä¸­æ¯ä¸€åˆ—çš„æœ€å¤§å€¼ï¼Œè¿”å›æœ€å¤§å€¼ä»¥åŠä»–çš„ä¸‹æ ‡ã€‚</p>
<h3 id="æ„å»ºç½‘ç»œç»“æ„"><a href="#æ„å»ºç½‘ç»œç»“æ„" class="headerlink" title="æ„å»ºç½‘ç»œç»“æ„"></a>æ„å»ºç½‘ç»œç»“æ„</h3><p>torch.nn ä¸»è¦å¤åˆ¶ç½‘ç»œçš„æ„å»ºï¼Œä½†æ˜¯å¾ˆå¤šæ—¶å€™ï¼Œtorch.nnä¸­ä¸æ»¡è¶³æˆ‘ä»¬éœ€è¦çš„ç½‘ç»œï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦è‡ªå·±å®šä¹‰ã€‚<code>torch.nn</code>ç»§æ‰¿è‡³<code>nn.Module</code>ï¼Œ<code>nn.Module</code>ä¸ºæ‰€æœ‰ç½‘ç»œçš„åŸºç±»ã€‚å½“æˆ‘ä»¬çš„ç½‘ç»œç±»ç»§æ‰¿è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œéœ€è¦å®ç°<code>__init__(),forward()</code>ä¸¤ä¸ªå‡½æ•°ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NerualNet</span><span class="params">(nn.Module)</span>:</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,input_size,hidden_size,output_size)</span>:</span></span><br><span class="line">    super(NerualNet,self).__init__()</span><br><span class="line">    self.fc1  = nn.Linear(input_size,hidden_size)</span><br><span class="line">    self.ReLu = nn.ReLU()</span><br><span class="line">    self.fc2  = nn.Linear(hidden_size,output_size)</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">forward</span><span class="params">(self,x)</span>:</span></span><br><span class="line">    out = self.fc1(x)</span><br><span class="line">    out = self.ReLu(out)</span><br><span class="line">    out = self.fc2(out)</span><br><span class="line">    <span class="keyword">return</span> out</span><br></pre></td></tr></table></figure>
<p>è°ƒç”¨æ—¶<code>model = NerualNet(input_size,hidden_size,output_size)</code>ï¼Œæ¯æ¬¡ä½¿ç”¨<code>model(x)</code>å³è‡ªåŠ¨æ‰§è¡Œforwardã€‚</p>
<h3 id="å·ç§¯å±‚"><a href="#å·ç§¯å±‚" class="headerlink" title="å·ç§¯å±‚"></a>å·ç§¯å±‚</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nn.Conv2d(in_channels,out_channels,kernel_size,stride=<span class="number">1</span>,padding=<span class="number">0</span>,dilation=<span class="number">1</span>,groups=<span class="number">1</span>,bias=<span class="keyword">True</span>)</span><br></pre></td></tr></table></figure>
<h3 id="æ„å»ºä¸€ä¸ªsequence"><a href="#æ„å»ºä¸€ä¸ªsequence" class="headerlink" title="æ„å»ºä¸€ä¸ªsequence"></a>æ„å»ºä¸€ä¸ªsequence</h3><p>sequence å°†åœ¨å…¶ä¸­çš„ç½‘ç»œå±‚ä»ä¸Šåˆ°ä¸‹è¿æ¥ä¸Šä¸€å±‚çš„è¾“å‡ºä½œä¸ºä¸‹ä¸€å±‚çš„è¾“å…¥ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Example of using Sequential</span></span><br><span class="line">model = nn.Sequential(</span><br><span class="line">          nn.Conv2d(<span class="number">1</span>,<span class="number">20</span>,<span class="number">5</span>),</span><br><span class="line">          nn.ReLU(),</span><br><span class="line">          nn.Conv2d(<span class="number">20</span>,<span class="number">64</span>,<span class="number">5</span>),</span><br><span class="line">          nn.ReLU()</span><br><span class="line">        )</span><br><span class="line"><span class="comment"># Example of using Sequential with OrderedDict</span></span><br><span class="line">model = nn.Sequential(OrderedDict([</span><br><span class="line">          (<span class="string">'conv1'</span>, nn.Conv2d(<span class="number">1</span>,<span class="number">20</span>,<span class="number">5</span>)),</span><br><span class="line">          (<span class="string">'relu1'</span>, nn.ReLU()),</span><br><span class="line">          (<span class="string">'conv2'</span>, nn.Conv2d(<span class="number">20</span>,<span class="number">64</span>,<span class="number">5</span>)),</span><br><span class="line">          (<span class="string">'relu2'</span>, nn.ReLU())</span><br><span class="line">        ]))</span><br></pre></td></tr></table></figure>
<h3 id="å›¾ç‰‡é¢„å¤„ç†é›†åˆ"><a href="#å›¾ç‰‡é¢„å¤„ç†é›†åˆ" class="headerlink" title="å›¾ç‰‡é¢„å¤„ç†é›†åˆ"></a>å›¾ç‰‡é¢„å¤„ç†é›†åˆ</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Image preprocessing modules</span></span><br><span class="line">transform = transforms.Compose([</span><br><span class="line">    transforms.Pad(<span class="number">4</span>),</span><br><span class="line">    transforms.RandomHorizontalFlip(),</span><br><span class="line">    transforms.RandomCrop(<span class="number">32</span>),</span><br><span class="line">    transforms.ToTensor()])</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­transforms.ToTensor()å°† PIL image tensor (H, W, C) in range [0,255] to a torch.Tensor(C, H, W) in the range [0.0, 1.0]ã€‚</p>
<h3 id="pytorch-ä¿å­˜ä»¥åŠå¯¼å…¥é¢„è®­ç»ƒå‚æ•°"><a href="#pytorch-ä¿å­˜ä»¥åŠå¯¼å…¥é¢„è®­ç»ƒå‚æ•°" class="headerlink" title="pytorch ä¿å­˜ä»¥åŠå¯¼å…¥é¢„è®­ç»ƒå‚æ•°"></a>pytorch ä¿å­˜ä»¥åŠå¯¼å…¥é¢„è®­ç»ƒå‚æ•°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">model = ResNet(residual,[<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>]).to(device)</span><br><span class="line">...</span><br><span class="line">torch.save(model,<span class="string">'model.ckpt'</span>) <span class="comment"># save the structure</span></span><br><span class="line">torch.save(model.state_dict(),<span class="string">'model_para.ckpt'</span>) <span class="comment"># save the parameter</span></span><br><span class="line"><span class="comment"># load</span></span><br><span class="line">model = torch.load(<span class="string">'model.ckpt'</span>)</span><br><span class="line"><span class="comment"># ä¸‹é¢çš„resnetç»“æ„éœ€è¦æå‰å®šä¹‰å¥½ </span></span><br><span class="line">resnet.load_state_dict(torch.load(<span class="string">'model_para.ckpt'</span>))</span><br></pre></td></tr></table></figure>
<h3 id="resentå®ç°éœ€è¦æ³¨æ„çš„åœ°æ–¹"><a href="#resentå®ç°éœ€è¦æ³¨æ„çš„åœ°æ–¹" class="headerlink" title="resentå®ç°éœ€è¦æ³¨æ„çš„åœ°æ–¹"></a>resentå®ç°éœ€è¦æ³¨æ„çš„åœ°æ–¹</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Residual block</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ResidualBlock</span><span class="params">(nn.Module)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, in_channels, out_channels, stride=<span class="number">1</span>, downsample=None)</span>:</span></span><br><span class="line">        super(ResidualBlock, self).__init__()</span><br><span class="line">        self.conv1 = conv3x3(in_channels, out_channels, stride)</span><br><span class="line">        self.bn1 = nn.BatchNorm2d(out_channels)</span><br><span class="line">        self.relu = nn.ReLU(inplace=<span class="keyword">True</span>)</span><br><span class="line">        self.conv2 = conv3x3(out_channels, out_channels)</span><br><span class="line">        self.bn2 = nn.BatchNorm2d(out_channels)</span><br><span class="line">        self.downsample = downsample</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">forward</span><span class="params">(self, x)</span>:</span></span><br><span class="line">        residual = x</span><br><span class="line">        out = self.conv1(x)</span><br><span class="line">        out = self.bn1(out)</span><br><span class="line">        out = self.relu(out)</span><br><span class="line">        out = self.conv2(out)</span><br><span class="line">        out = self.bn2(out)</span><br><span class="line">        <span class="keyword">if</span> self.downsample:</span><br><span class="line">            residual = self.downsample(x)</span><br><span class="line">        out += residual</span><br><span class="line">        out = self.relu(out)</span><br><span class="line">        <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"><span class="comment"># ResNet</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ResNet</span><span class="params">(nn.Module)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, block, layers, num_classes=<span class="number">10</span>)</span>:</span></span><br><span class="line">        super(ResNet, self).__init__()</span><br><span class="line">        self.in_channels = <span class="number">16</span></span><br><span class="line">        self.conv = conv3x3(<span class="number">3</span>, <span class="number">16</span>)</span><br><span class="line">        self.bn = nn.BatchNorm2d(<span class="number">16</span>)</span><br><span class="line">        self.relu = nn.ReLU(inplace=<span class="keyword">True</span>)</span><br><span class="line">        self.layer1 = self.make_layer(block, <span class="number">16</span>, layers[<span class="number">0</span>])</span><br><span class="line">        self.layer2 = self.make_layer(block, <span class="number">32</span>, layers[<span class="number">1</span>], <span class="number">2</span>)</span><br><span class="line">        self.layer3 = self.make_layer(block, <span class="number">64</span>, layers[<span class="number">2</span>], <span class="number">2</span>)</span><br><span class="line">        self.avg_pool = nn.AvgPool2d(<span class="number">8</span>)</span><br><span class="line">        self.fc = nn.Linear(<span class="number">64</span>, num_classes)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">make_layer</span><span class="params">(self, block, out_channels, blocks, stride=<span class="number">1</span>)</span>:</span></span><br><span class="line">        downsample = <span class="keyword">None</span></span><br><span class="line">        <span class="keyword">if</span> (stride != <span class="number">1</span>) <span class="keyword">or</span> (self.in_channels != out_channels):</span><br><span class="line">            downsample = nn.Sequential(</span><br><span class="line">                conv3x3(self.in_channels, out_channels, stride=stride),</span><br><span class="line">                nn.BatchNorm2d(out_channels))</span><br><span class="line">        layers = []</span><br><span class="line">        layers.append(block(self.in_channels, out_channels, stride, downsample))</span><br><span class="line">        self.in_channels = out_channels</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, blocks):</span><br><span class="line">            layers.append(block(out_channels, out_channels))</span><br><span class="line">        <span class="keyword">return</span> nn.Sequential(*layers)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">forward</span><span class="params">(self, x)</span>:</span></span><br><span class="line">        out = self.conv(x)</span><br><span class="line">        out = self.bn(out)</span><br><span class="line">        out = self.relu(out)</span><br><span class="line">        out = self.layer1(out)</span><br><span class="line">        out = self.layer2(out)</span><br><span class="line">        out = self.layer3(out)</span><br><span class="line">        out = self.avg_pool(out)</span><br><span class="line">        out = out.view(out.size(<span class="number">0</span>), <span class="number">-1</span>)</span><br><span class="line">        out = self.fc(out)</span><br><span class="line">        <span class="keyword">return</span> out</span><br></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç åœ¨ç»“æ„è®¾è®¡ä¸Šï¼Œå°†residualä»æ•´ä¸ªç½‘ç»œä¸­å‰¥ç¦»å‡ºæ¥ã€‚residualéƒ¨åˆ†åœ¨resnetä¸­å¤šæ¬¡ä½¿ç”¨ï¼Œå¯ä»¥èµ·åˆ°ä»£ç å¤ç”¨ã€‚è¿™residualè¿™ä¸€éƒ¨åˆ†åŒæ ·ç»§æ‰¿äº†nn.moduleï¼Œåœ¨resnetä¸­è¿›è¡Œè°ƒç”¨ã€‚åœ¨æ•´ä¸ªç½‘ç»œåå‘æ±‚å¯¼çš„è¿‡ç¨‹ä¸­ï¼ŒåŒæ ·å¯ä»¥åå‘ä¼ æ’­ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">out = out.view(out.size(<span class="number">0</span>),<span class="number">-1</span>) <span class="comment"># å³ä¿æŒç¬¬ä¸€ç»´ä¸å˜ï¼Œç„¶ååé¢çš„æ‰€æœ‰çš„ç»´åº¦ç‰¹å¾è¿›è¡Œflattenå±•å¼€ã€‚ç±»ä¼¼äºreshapeã€‚</span></span><br><span class="line">out = out.shape(out.size(<span class="number">0</span>),<span class="number">-1</span>)</span><br></pre></td></tr></table></figure>
<p>åœ¨å¯¹resentè¿›è¡Œevaluateçš„æ—¶å€™ï¼Œéœ€è¦å…ˆæ‰§è¡Œ<code>model.eval()</code>ã€‚è¿™æ˜¯å› ä¸ºbnï¼Œdropoutè¿™äº›æ“ä½œåœ¨è®­ç»ƒå’Œæµ‹è¯•çš„é˜¶æ®µä¸ä¸€æ ·ã€‚</p>
<h3 id="pytorchä¸­çš„LSTMçš„è°ƒç”¨"><a href="#pytorchä¸­çš„LSTMçš„è°ƒç”¨" class="headerlink" title="pytorchä¸­çš„LSTMçš„è°ƒç”¨"></a>pytorchä¸­çš„LSTMçš„è°ƒç”¨</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Recurrent neural network (many-to-one)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RNN</span><span class="params">(nn.Module)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, input_size, hidden_size, num_layers, num_classes)</span>:</span></span><br><span class="line">        super(RNN, self).__init__()</span><br><span class="line">        self.hidden_size = hidden_size</span><br><span class="line">        self.num_layers = num_layers</span><br><span class="line">        self.lstm = nn.LSTM(input_size, hidden_size, num_layers, batch_first=<span class="keyword">True</span>)</span><br><span class="line">        self.fc = nn.Linear(hidden_size, num_classes)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">forward</span><span class="params">(self, x)</span>:</span></span><br><span class="line">        <span class="comment"># Set initial hidden and cell states </span></span><br><span class="line">        h0 = torch.zeros(self.num_layers, x.size(<span class="number">0</span>), self.hidden_size).to(device) </span><br><span class="line">        c0 = torch.zeros(self.num_layers, x.size(<span class="number">0</span>), self.hidden_size).to(device)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Forward propagate LSTM</span></span><br><span class="line">        out, _ = self.lstm(x, (h0, c0))  <span class="comment"># out: tensor of shape (batch_size, seq_length, hidden_size)</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Decode the hidden state of the last time step</span></span><br><span class="line">        out = self.fc(out[:, <span class="number">-1</span>, :])<span class="comment"># å› ä¸ºæœ‰è®¸å¤šå±‚ï¼Œåªè¦æœ€åä¸€å±‚</span></span><br><span class="line">        <span class="keyword">return</span> out</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­LSTMè°ƒç”¨ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nn.LSTM(input_size,hidden_size,num_layersï¼Œbatch_first=<span class="keyword">True</span>)</span><br><span class="line"><span class="comment"># input_size æŒ‡è¾“å…¥çš„ä¸€ä¸ªæ•°æ®å«æœ‰çš„ç‰¹å¾æ•°ï¼ˆç»´åº¦ï¼‰</span></span><br><span class="line"><span class="comment"># hidden_size æŒ‡éšè—è¾“å‡ºå…·æœ‰çš„ç‰¹å¾</span></span><br><span class="line"><span class="comment"># num_layer æŒ‡å…±æœ‰å¤šå°‘ä¸ªLSTMå±‚å åœ¨ä¸€èµ·</span></span><br><span class="line"><span class="comment"># batch_first æŒ‡LSTMè¾“å‡ºçš„hå’Œcç¬¬ä¸€ä¸ªç»´åº¦éƒ½ä¸ºbatch</span></span><br></pre></td></tr></table></figure>
<p>hï¼šhidden</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">h0 = torch.zeros(self,num_layers,x.size(<span class="number">0</span>),self.hidden_size)</span><br><span class="line"><span class="comment"># æŒ‡hiddenå¤„çš„å‚æ•°</span></span><br><span class="line"><span class="comment"># num_layerså€¼å…±æœ‰å‡ å±‚</span></span><br><span class="line"><span class="comment"># batch_size=x.size(0) å…±æœ‰å‡ ä¸ªbatch</span></span><br><span class="line"><span class="comment"># hidden_size: è¾“å‡ºçš„hiddenç‰¹å¾æ•°</span></span><br></pre></td></tr></table></figure>
<p>cï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">c0 = torch.zeros(self.num_layers,x.size(<span class="number">0</span>),self.hidden_size)</span><br><span class="line"><span class="comment"># å‚æ•°ä¸ä¸Šç›¸åŒ</span></span><br></pre></td></tr></table></figure>
<p>è°ƒç”¨ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">out,(hn,cn) = self.lstm(x,(h0,c0))</span><br></pre></td></tr></table></figure>
<h3 id="ä¸€ä¸ªè¾ƒå¤§é¡¹ç›®çš„ä»£ç å¸ƒå±€é€»è¾‘"><a href="#ä¸€ä¸ªè¾ƒå¤§é¡¹ç›®çš„ä»£ç å¸ƒå±€é€»è¾‘" class="headerlink" title="ä¸€ä¸ªè¾ƒå¤§é¡¹ç›®çš„ä»£ç å¸ƒå±€é€»è¾‘"></a>ä¸€ä¸ªè¾ƒå¤§é¡¹ç›®çš„ä»£ç å¸ƒå±€é€»è¾‘</h3><p><code>train.py</code> : ç¨‹åºå¼€å§‹æ‰§è¡Œçš„åœ°æ–¹ï¼Œä½œä¸ºæ•´ä¸ªé¡¹ç›®çš„æ ¸å¿ƒæŒ‡æŒ¥ï¼Œè´Ÿè´£å¯¹ä¸ªä¸ªéƒ¨åˆ†è¿›è¡Œè°ƒåº¦ã€‚ä»–çš„ä¸»è¦æ€è·¯å¦‚ä¸‹ï¼š</p>
<p>ã€1ã€‘é€šè¿‡argparseæ¥å—ä¼ å…¥çš„å„ç§é…ç½®å‚æ•°ï¼ŒåŒ…æ‹¬æ•°æ®é›†çš„è·¯å¾„ï¼Œmodelçš„å­˜å‚¨è·¯å¾„ç­‰ç­‰ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ = <span class="string">'__main__'</span>:</span><br><span class="line">  parse = argparse.ArgumentParser()</span><br><span class="line">  parse.add_element(<span class="string">'--model_path'</span>,type=str,default=<span class="string">'./models'</span>,help=<span class="string">'saving training model'</span>)</span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>
<p>ã€2ã€‘è°ƒç”¨main() å‡½æ•°ï¼Œå¼€å§‹æ‰§è¡Œç¨‹åºã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é¦–å…ˆæ‰§è¡Œimage progressingæ­¥éª¤ï¼Œå¯¹å›¾ç‰‡è¿›è¡Œé¢„å¤„ç†éƒ¨åˆ†</span></span><br><span class="line">transform = transforms.Compose([</span><br><span class="line">  transforms.RandomCrop(args.crop_size),</span><br><span class="line">  trnasforms.RandomHorizontalFlip(),</span><br><span class="line">  ...</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="comment"># build data loader</span></span><br><span class="line"><span class="comment"># æ­¤å¤„å®ç°äº†ä¸€ä¸ªç»§æ‰¿torch.utils.data.Datasetçš„æ•°æ®é›†å¤„ç†ç±»ï¼Œå®ç°äº†__init__ä»¥åŠ__getitem__ã€‚</span></span><br><span class="line">data_loader = get_loader(args.image_dir, args.caption_path, vocab,transform, args.batch_size,shuffle=<span class="keyword">True</span>, num_workers=args.num_workers) </span><br><span class="line"></span><br><span class="line"><span class="comment"># build the model</span></span><br><span class="line"><span class="comment"># æ­¤å¤„å®ç°äº†ä¸€ä¸ªmodelç±»ï¼Œç»§æ‰¿è‡³nn.Module</span></span><br><span class="line">encoder = EncoderCNN(args.embed_size).to(device)</span><br><span class="line">decoder = DecoderRNN(args.embed_size, args.hidden_size, len(vocab), args.num_layers).to(device)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºlossä»¥åŠoptimizer</span></span><br><span class="line">criterion = nn.CrossEntropyLoss()</span><br><span class="line">    params = list(decoder.parameters()) + list(encoder.linear.parameters()) + list(encoder.bn.parameters())</span><br><span class="line">    optimizer = torch.optim.Adam(params, lr=args.learning_rate)</span><br><span class="line">    </span><br><span class="line"><span class="comment">## train the model,é€šè¿‡data loaderæ¥äº§ç”Ÿæ•°æ®</span></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> range(args.num_epochs):</span><br><span class="line">  <span class="comment"># è·å–batchæ•°æ®ï¼Œè¿›è¡Œè®­ç»ƒä»¥åŠé¢„æµ‹</span></span><br></pre></td></tr></table></figure>
</div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>æœ¬æ–‡ä½œè€…ï¼š</strong>WenHui Zhou</li><li class="post-copyright-link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="/2019/03/29/pytorch-åŸºæœ¬è¯­æ³•/">https://wenhui-zhou.github.io/2019/03/29/pytorch-åŸºæœ¬è¯­æ³•/</a></li><li class="post-copyright-license"><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>| æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="&quot;http://creativecommons.org/licenses/by-nc-sa/3.0/cn/&quot;" rel="&quot;external" nofollow&quot;="" target="&quot;_blank&quot;">CC BY-NC-SA 3.0 CN</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼ </li></ul></div><br><div class="tags"><a href="/tags/æ·±åº¦å­¦ä¹ /">æ·±åº¦å­¦ä¹ </a></div><div class="post-nav"><a class="pre" href="/2019/04/09/VOC-æ•°æ®é›†/">VOC æ•°æ®é›†</a><a class="next" href="/2019/03/29/SSD-å¤ç°/">SSD å¤ç°</a></div><div id="vcomment"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script><script>var notify = 'false' == true ? true : false;
var verify = 'false' == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'civq9nKD49NpRALooR9Llqmf-gzGzoHsz',
  appKey:'JggO9HaSi1Lfx17nt16oDfsI',
  placeholder:'Shall we talk',
  avatar:'mm',
  guest_info:guest_info,
  pageSize:'10'
})</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> åˆ†ç±»</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Mac/">Mac</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tensorflow/">Tensorflow</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/super-resolution/">super resolution</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/tool/">tool</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/xigua/">xigua</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/å»ºç«™/">å»ºç«™</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/æ‰‹æ’•ç³»åˆ—/">æ‰‹æ’•ç³»åˆ—</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/æ¨¡å‹è¯„ä»·/">æ¨¡å‹è¯„ä»·</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/æ¯”èµ›/">æ¯”èµ›</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ç¼–ç¨‹/">ç¼–ç¨‹</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/è®ºæ–‡å¤ç°/">è®ºæ–‡å¤ç°</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/è®ºæ–‡é˜…è¯»/">è®ºæ–‡é˜…è¯»</a><span class="category-list-count">20</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/é¡¹ç›®/">é¡¹ç›®</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/é¡¹ç›®æ€»ç»“/">é¡¹ç›®æ€»ç»“</a><span class="category-list-count">4</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/é¡¹ç›®æ€»ç»“/è®ºæ–‡é˜…è¯»/">è®ºæ–‡é˜…è¯»</a><span class="category-list-count">3</span></li></ul></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> æ ‡ç­¾</i></div><div class="tagcloud"><a href="/tags/interview/" style="font-size: 15px;">interview</a> <a href="/tags/æ·±åº¦å­¦ä¹ /" style="font-size: 15px;">æ·±åº¦å­¦ä¹ </a> <a href="/tags/c/" style="font-size: 15px;">c++</a> <a href="/tags/leetcode/" style="font-size: 15px;">leetcode</a> <a href="/tags/netStation/" style="font-size: 15px;">netStation</a> <a href="/tags/tool/" style="font-size: 15px;">tool</a> <a href="/tags/dialog/" style="font-size: 15px;">dialog</a> <a href="/tags/tip/" style="font-size: 15px;">tip</a> <a href="/tags/Tensorflow/" style="font-size: 15px;">Tensorflow</a> <a href="/tags/tips/" style="font-size: 15px;">tips</a> <a href="/tags/â€”-leetcode/" style="font-size: 15px;">â€” leetcode</a> <a href="/tags/ç®—æ³•/" style="font-size: 15px;">ç®—æ³•</a> <a href="/tags/è®ºæ–‡é˜…è¯»/" style="font-size: 15px;">è®ºæ–‡é˜…è¯»</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> æœ€è¿‘æ–‡ç« </i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/08/22/å †æ’åºï¼Œpythonå®ç°/">å †æ’åºï¼Œpythonå®ç°</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/08/16/æ·±åº¦å­¦ä¹ ä»£ç çš„æ¡†æ¶/">æ·±åº¦å­¦ä¹ ä»£ç çš„æ¡†æ¶</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/24/normalization/">normalization</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/23/image-upsample-downsample-method/">image upsample-downsample method</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/23/Deep-Learning-for-image-Super-resolution-a-Survey/">Deep Learning for image Super-resolution: a Survey</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/23/ä¸€äº›æå‡æ•ˆç‡çš„æ–¹æ³•/">ä¸€äº›æå‡æ•ˆç‡çš„æ–¹æ³•</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/21/xigua-æ”¯æŒå‘é‡æœº/">xigua-æ”¯æŒå‘é‡æœº</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/20/xigua-ç¥ç»ç½‘ç»œ/">xigua-ç¥ç»ç½‘ç»œ</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/19/19-7-2019-preview/">19/7/2019 preview</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/17/å‰ç¼€æ ‘ğŸŒ²-trie/">å‰ç¼€æ ‘ğŸŒ²:trie</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> å‹æƒ…é“¾æ¥</i></div><ul></ul><a href="https://github.com/WenHui-Zhou" title="GITHUB" target="_blank">GITHUB</a><ul></ul><a href="http://www.google.com/" title="GOOGLE" target="_blank">GOOGLE</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright Â© 2019 <a href="/." rel="nofollow">WenHuiZhou.</a> è®¿é—®äººæ•°:<span id="busuanzi_value_site_uv"></span> 
è®¿é—®é‡:<span id="busuanzi_value_site_pv"></span></div><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> </div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.css"><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>